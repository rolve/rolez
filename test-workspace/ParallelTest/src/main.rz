package foo

import rolez.util.Scanner

class App {
	
	val co: int
	
	new {
		this.co = 42;
	}
	
	task pure main(args: readonly Array[readonly String]): { 
		//the System.out.println("footest");
		var dummy = new App; 
		val vh = new ValueHolder;
		
		parallel 
			this.foo(this.co, new Object, vh); 
		and 
			this.foo(this.co, new Object, vh); 
		
		parfor(var j = 0; j < 16; j++) 
			this.foo(j, this.makeObj(j), vh);
		
		
		the System.out.println("args:");
		for(var i = 0; i < args.length; i += 1)
			the System.out.println("  " + args.get(i));	
		 
		the System.out.println("\nNow type your name:");
		val scanner = new Scanner(the System.in);
		
		var continue = true;
		while(continue) {
			val line = scanner.nextLine;
			if(line.equals("stop"))
				continue = false; 
			else
				the System.out.println("Hello " + line + "!");
		}
	}
	
	task pure foo(n: int, a: readwrite Object, vh: readonly Object): {
		the System.out.println("foo" + n);	
	}
	
	def pure makeObj(n: int): readwrite Object {
		the System.out.println("making an object "+n);	
		return new Object();
	}
	
}

class ValueHolder {
	val value: int
	
	new {
		this.value = 50;
	}
}
